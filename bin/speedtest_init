#!/usr/bin/env ruby
require 'yaml'
require_relative '../lib/speed_test'

cli = SpeedTest::CLI.parse(ARGV)
config_path = "~/.config/speedtest"

if cli.setup
  SpeedTest::Setup.execute(cli, config_path)
elsif cli.measure
  settings = SpeedTest::Settings.load(config_path)
  measurements = SpeedTest::SpeedData.new
  wireless = SpeedTest::ConnectionType.new.wireless?
  SpeedTest::SaveData.execute(output_path: settings.output, data: measurements, wireless: wireless)
else
  warn "Speedtest CLI received no options!"
  system('speedtest_init -h')
end
